import{u as _,h as ie,i as le,j as M,k as ae,P as se,t as ne,l as ue,m as L,p as q,q as te,w as B,v as l,x as re,R as O,y as oe,z as he,A as ye,C as ce,B as ge,D as ve,E as pe,F as ze,G as de,H as R,I as me,J as ke,K as fe,L as T,M as $,N as be}from"./app-C9u3C4ER.js";const we=["/","/draw","/qianyan","/qunliao","/thankU","/zanzhu","/about/","/about/fankui","/about/me","/jieshao/","/jieshao/catwo","/jieshao/neko","/zhiling/","/zhiling/help","/zhuyi/","/zhuyi/terms","/zhuyi/xuzhi","/zhiling/AI/","/zhiling/AI/neko","/zhiling/AI/summarygroup","/zhiling/acg/DeltaForce","/zhiling/acg/","/zhiling/acg/ark","/zhiling/acg/ba","/zhiling/acg/bf","/zhiling/acg/genshin","/zhiling/acg/guangyu","/zhiling/acg/juequ0","/zhiling/acg/mingchao","/zhiling/acg/sr","/zhiling/acg/wws","/zhiling/shiyong/Multi-Source%20Daily","/zhiling/shiyong/","/zhiling/shiyong/bw","/zhiling/shiyong/code","/zhiling/shiyong/english","/zhiling/shiyong/imgS","/zhiling/shiyong/imga","/zhiling/shiyong/imgts","/zhiling/shiyong/music","/zhiling/shiyong/price","/zhiling/shiyong/status","/zhiling/shiyong/train","/zhiling/yinyou/BangDream","/zhiling/yinyou/","/zhiling/yinyou/bs","/zhiling/yinyou/chu","/zhiling/yinyou/maimai","/zhiling/yinyou/osu","/zhiling/yinyou/pgr","/zhiling/yule/Atri","/zhiling/yule/Earth-K-Plugin","/zhiling/yule/KFCcrazythursdayvme50","/zhiling/yule/L-Plugin","/zhiling/yule/Poke-Plugin","/zhiling/yule/","/zhiling/yule/abook","/zhiling/yule/bamotalk","/zhiling/yule/bottle","/zhiling/yule/bqb","/zhiling/yule/bqbmaker","/zhiling/yule/cao","/zhiling/yule/ciyun","/zhiling/yule/cxh","/zhiling/yule/dinshi","/zhiling/yule/emoji","/zhiling/yule/fabing","/zhiling/yule/hajimi","/zhiling/yule/homo","/zhiling/yule/jitang","/zhiling/yule/jq","/zhiling/yule/jrrp","/zhiling/yule/megumin","/zhiling/yule/mypower","/zhiling/yule/oooo","/zhiling/yule/otto","/zhiling/yule/qiandao","/zhiling/yule/todaycatgirl","/zhiling/yule/todaywife","/zhiling/yule/wordle","/zhiling/yule/yiyan","/zhiling/yule/zhanbu","/zhiling/yinyou/arc/","/zhiling/yinyou/arc/arc","/zhiling/yinyou/arc/b30","/zhiling/yinyou/pjsk/","/zhiling/yinyou/pjsk/haruki","/zhiling/yinyou/pjsk/pjsk","/zhiling/yinyou/pjsk/uni","/404.html"],He="SEARCH_PRO_QUERY_HISTORY",d=_(He,[]),qe=()=>{const{queryHistoryCount:a}=R,s=a>0;return{enabled:s,queryHistory:d,addQueryHistory:n=>{s&&(d.value=Array.from(new Set([n,...d.value.slice(0,a-1)])))},removeQueryHistory:n=>{d.value=[...d.value.slice(0,n),...d.value.slice(n+1)]}}},P=a=>we[a.id]+("anchor"in a?`#${a.anchor}`:""),Re="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:U}=R,m=_(Re,[]),je=()=>{const a=U>0;return{enabled:a,resultHistory:m,addResultHistory:s=>{if(a){const n={link:P(s),display:s.display};"header"in s&&(n.header=s.header),m.value=[n,...m.value.slice(0,U-1)]}},removeResultHistory:s=>{m.value=[...m.value.slice(0,s),...m.value.slice(s+1)]}}},xe=a=>{const s=ce(),n=M(),j=ge(),t=L(0),b=q(()=>t.value>0),v=ve([]);return pe(()=>{const{search:p,terminate:x}=ze(),k=de(h=>{const f=h.join(" "),{searchFilter:Q=g=>g,splitWord:S,suggestionsFilter:E,...z}=s.value;f?(t.value+=1,p(h.join(" "),n.value,z).then(g=>Q(g,f,n.value,j.value)).then(g=>{t.value-=1,v.value=g}).catch(g=>{console.warn(g),t.value-=1,t.value||(v.value=[])})):v.value=[]},R.searchDelay-R.suggestDelay);B([a,n],([h])=>k(h),{immediate:!0}),me(()=>{x()})}),{isSearching:b,results:v}};var Se=ie({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:s}){const n=le(),j=M(),t=ae(se),{enabled:b,addQueryHistory:v,queryHistory:p,removeQueryHistory:x}=qe(),{enabled:k,resultHistory:h,addResultHistory:f,removeResultHistory:Q}=je(),S=b||k,E=ne(a,"queries"),{results:z,isSearching:g}=xe(E),u=ue({isQuery:!0,index:0}),y=L(0),c=L(0),F=q(()=>S&&(p.value.length>0||h.value.length>0)),C=q(()=>z.value.length>0),D=q(()=>z.value[y.value]||null),K=()=>{const{isQuery:e,index:i}=u;i===0?(u.isQuery=!e,u.index=e?h.value.length-1:p.value.length-1):u.index=i-1},Y=()=>{const{isQuery:e,index:i}=u;i===(e?p.value.length-1:h.value.length-1)?(u.isQuery=!e,u.index=0):u.index=i+1},G=()=>{y.value=y.value>0?y.value-1:z.value.length-1,c.value=D.value.contents.length-1},J=()=>{y.value=y.value<z.value.length-1?y.value+1:0,c.value=0},N=()=>{c.value<D.value.contents.length-1?c.value+=1:J()},V=()=>{c.value>0?c.value-=1:G()},A=e=>e.map(i=>be(i)?i:l(i[0],i[1])),W=e=>{if(e.type==="customField"){const i=ke[e.index]||"$content",[r,H=""]=fe(i)?i[j.value].split("$content"):i.split("$content");return e.display.map(o=>l("div",A([r,...o,H])))}return e.display.map(i=>l("div",A(i)))},w=()=>{y.value=0,c.value=0,s("updateQuery",""),s("close")},X=()=>b?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},t.value.queryHistory),p.value.map((e,i)=>l("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===i}],onClick:()=>{s("updateQuery",e)}},[l(T,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:r=>{r.preventDefault(),r.stopPropagation(),x(i)}})]))])):null,Z=()=>k?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},t.value.resultHistory),h.value.map((e,i)=>l(O,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===i}],onClick:()=>{w()}},()=>[l(T,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(r=>A(r)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:r=>{r.preventDefault(),r.stopPropagation(),Q(i)}})]))])):null;return te("keydown",e=>{if(a.isFocusing){if(C.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")N();else if(e.key==="Enter"){const i=D.value.contents[c.value];v(a.queries.join(" ")),f(i),n.push(P(i)),w()}}else if(k){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:i}=u;u.isQuery?(s("updateQuery",p.value[i]),e.preventDefault()):(n.push(h.value[i].link),w())}}}}),B([y,c],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!C.value:!F.value}],id:"search-pro-results"},a.queries.length?g.value?l(re,{hint:t.value.searching}):C.value?l("ul",{class:"search-pro-result-list"},z.value.map(({title:e,contents:i},r)=>{const H=y.value===r;return l("li",{class:["search-pro-result-list-item",{active:H}]},[l("div",{class:"search-pro-result-title"},e||t.value.defaultTitle),i.map((o,ee)=>{const I=H&&c.value===ee;return l(O,{to:P(o),class:["search-pro-result-item",{active:I,"aria-selected":I}],onClick:()=>{v(a.queries.join(" ")),f(o),w()}},()=>[o.type==="text"?null:l(o.type==="title"?oe:o.type==="heading"?he:ye,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[o.type==="text"&&o.header?l("div",{class:"content-header"},o.header):null,l("div",W(o))])])})])})):t.value.emptyResult:S?F.value?[X(),Z()]:t.value.emptyHistory:t.value.emptyResult)}});export{Se as default};
