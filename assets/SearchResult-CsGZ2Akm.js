import{u as _,i as ie,j as le,k as M,l as ae,P as se,t as ne,m as ue,p as P,q,v as te,w as B,x as l,y as re,R as I,z as oe,A as he,B as ye,C as ge,D as ce,E as ve,F as ze,G as pe,H as de,I as R,J as me,K as ke,L as fe,M as T,N as $,O as be}from"./app-BdiO1pdG.js";const we=["/","/draw","/qianyan","/qunliao","/thankU","/zanzhu","/about/","/about/fankui","/about/me","/jieshao/","/jieshao/catwo","/jieshao/neko","/zhiling/","/zhiling/help","/zhuyi/","/zhuyi/faq","/zhuyi/terms","/zhuyi/xuzhi","/zhiling/AI/","/zhiling/acg/CSGO","/zhiling/acg/DeltaForce","/zhiling/acg/","/zhiling/acg/ark","/zhiling/acg/ba","/zhiling/acg/bf","/zhiling/acg/genshin","/zhiling/acg/guangyu","/zhiling/acg/juequ0","/zhiling/acg/l4d2","/zhiling/acg/limbus","/zhiling/acg/mingchao","/zhiling/acg/sr","/zhiling/acg/wot","/zhiling/acg/wws","/zhiling/shiyong/Multi-Source%20Daily","/zhiling/shiyong/","/zhiling/shiyong/bw","/zhiling/shiyong/code","/zhiling/shiyong/disconnect","/zhiling/shiyong/english","/zhiling/shiyong/githubcard","/zhiling/shiyong/imgS","/zhiling/shiyong/imga","/zhiling/shiyong/imgts","/zhiling/shiyong/music","/zhiling/shiyong/parser","/zhiling/shiyong/price","/zhiling/shiyong/status","/zhiling/shiyong/train","/zhiling/shiyong/wsk","/zhiling/yinyou/BangDream","/zhiling/yinyou/","/zhiling/yinyou/bs","/zhiling/yinyou/chu","/zhiling/yinyou/maimai","/zhiling/yinyou/osu","/zhiling/yinyou/pgr","/zhiling/yinyou/vs","/zhiling/yule/Atri","/zhiling/yule/Earth-K-Plugin","/zhiling/yule/KFCcrazythursdayvme50","/zhiling/yule/L-Plugin","/zhiling/yule/Poke-Plugin","/zhiling/yule/","/zhiling/yule/abook","/zhiling/yule/bamotalk","/zhiling/yule/bottle","/zhiling/yule/bqb","/zhiling/yule/bqbmaker","/zhiling/yule/cao","/zhiling/yule/ciyun","/zhiling/yule/cxh","/zhiling/yule/dinshi","/zhiling/yule/emoji","/zhiling/yule/fabing","/zhiling/yule/hajimi","/zhiling/yule/homo","/zhiling/yule/jitang","/zhiling/yule/jq","/zhiling/yule/jrrp","/zhiling/yule/megumin","/zhiling/yule/mypower","/zhiling/yule/oooo","/zhiling/yule/otto","/zhiling/yule/qiandao","/zhiling/yule/todaycatgirl","/zhiling/yule/todaywife","/zhiling/yule/wordle","/zhiling/yule/yiyan","/zhiling/yule/zhanbu","/zhiling/yinyou/arc/","/zhiling/yinyou/arc/arc","/zhiling/yinyou/arc/b30","/zhiling/yinyou/pjsk/","/zhiling/yinyou/pjsk/haruki","/zhiling/yinyou/pjsk/pjsk","/zhiling/yinyou/pjsk/uni","/404.html"],He="SEARCH_PRO_QUERY_HISTORY",d=_(He,[]),qe=()=>{const{queryHistoryCount:a}=R,s=a>0;return{enabled:s,queryHistory:d,addQueryHistory:n=>{s&&(d.value=Array.from(new Set([n,...d.value.slice(0,a-1)])))},removeQueryHistory:n=>{d.value=[...d.value.slice(0,n),...d.value.slice(n+1)]}}},A=a=>we[a.id]+("anchor"in a?`#${a.anchor}`:""),Re="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:U}=R,m=_(Re,[]),je=()=>{const a=U>0;return{enabled:a,resultHistory:m,addResultHistory:s=>{if(a){const n={link:A(s),display:s.display};"header"in s&&(n.header=s.header),m.value=[n,...m.value.slice(0,U-1)]}},removeResultHistory:s=>{m.value=[...m.value.slice(0,s),...m.value.slice(s+1)]}}},xe=a=>{const s=ge(),n=M(),j=ce(),t=P(0),b=q(()=>t.value>0),v=ve([]);return ze(()=>{const{search:z,terminate:x}=pe(),k=de(h=>{const f=h.join(" "),{searchFilter:Q=c=>c,splitWord:S,suggestionsFilter:E,...p}=s.value;f?(t.value+=1,z(h.join(" "),n.value,p).then(c=>Q(c,f,n.value,j.value)).then(c=>{t.value-=1,v.value=c}).catch(c=>{console.warn(c),t.value-=1,t.value||(v.value=[])})):v.value=[]},R.searchDelay-R.suggestDelay);B([a,n],([h])=>k(h),{immediate:!0}),me(()=>{x()})}),{isSearching:b,results:v}};var Se=ie({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:s}){const n=le(),j=M(),t=ae(se),{enabled:b,addQueryHistory:v,queryHistory:z,removeQueryHistory:x}=qe(),{enabled:k,resultHistory:h,addResultHistory:f,removeResultHistory:Q}=je(),S=b||k,E=ne(a,"queries"),{results:p,isSearching:c}=xe(E),u=ue({isQuery:!0,index:0}),y=P(0),g=P(0),F=q(()=>S&&(z.value.length>0||h.value.length>0)),C=q(()=>p.value.length>0),D=q(()=>p.value[y.value]||null),K=()=>{const{isQuery:e,index:i}=u;i===0?(u.isQuery=!e,u.index=e?h.value.length-1:z.value.length-1):u.index=i-1},Y=()=>{const{isQuery:e,index:i}=u;i===(e?z.value.length-1:h.value.length-1)?(u.isQuery=!e,u.index=0):u.index=i+1},G=()=>{y.value=y.value>0?y.value-1:p.value.length-1,g.value=D.value.contents.length-1},J=()=>{y.value=y.value<p.value.length-1?y.value+1:0,g.value=0},N=()=>{g.value<D.value.contents.length-1?g.value+=1:J()},V=()=>{g.value>0?g.value-=1:G()},L=e=>e.map(i=>be(i)?i:l(i[0],i[1])),W=e=>{if(e.type==="customField"){const i=ke[e.index]||"$content",[r,H=""]=fe(i)?i[j.value].split("$content"):i.split("$content");return e.display.map(o=>l("div",L([r,...o,H])))}return e.display.map(i=>l("div",L(i)))},w=()=>{y.value=0,g.value=0,s("updateQuery",""),s("close")},X=()=>b?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},t.value.queryHistory),z.value.map((e,i)=>l("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===i}],onClick:()=>{s("updateQuery",e)}},[l(T,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:r=>{r.preventDefault(),r.stopPropagation(),x(i)}})]))])):null,Z=()=>k?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},t.value.resultHistory),h.value.map((e,i)=>l(I,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===i}],onClick:()=>{w()}},()=>[l(T,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(r=>L(r)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:r=>{r.preventDefault(),r.stopPropagation(),Q(i)}})]))])):null;return te("keydown",e=>{if(a.isFocusing){if(C.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")N();else if(e.key==="Enter"){const i=D.value.contents[g.value];v(a.queries.join(" ")),f(i),n.push(A(i)),w()}}else if(k){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:i}=u;u.isQuery?(s("updateQuery",z.value[i]),e.preventDefault()):(n.push(h.value[i].link),w())}}}}),B([y,g],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!C.value:!F.value}],id:"search-pro-results"},a.queries.length?c.value?l(re,{hint:t.value.searching}):C.value?l("ul",{class:"search-pro-result-list"},p.value.map(({title:e,contents:i},r)=>{const H=y.value===r;return l("li",{class:["search-pro-result-list-item",{active:H}]},[l("div",{class:"search-pro-result-title"},e||t.value.defaultTitle),i.map((o,ee)=>{const O=H&&g.value===ee;return l(I,{to:A(o),class:["search-pro-result-item",{active:O,"aria-selected":O}],onClick:()=>{v(a.queries.join(" ")),f(o),w()}},()=>[o.type==="text"?null:l(o.type==="title"?oe:o.type==="heading"?he:ye,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[o.type==="text"&&o.header?l("div",{class:"content-header"},o.header):null,l("div",W(o))])])})])})):t.value.emptyResult:S?F.value?[X(),Z()]:t.value.emptyHistory:t.value.emptyResult)}});export{Se as default};
